{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/ondrejrehacek/Git/Stash/stash-pay-web/packages/stash-pay/dist/StashPay.js"],"sourcesContent":["'use client';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { useEffect, useState, useRef } from 'react';\n// Stash types\nexport var StashWindowEvent;\n(function (StashWindowEvent) {\n    StashWindowEvent[\"PAYMENT_FAILURE\"] = \"PAYMENT_FAILURE\";\n    StashWindowEvent[\"PAYMENT_SUCCESS\"] = \"PAYMENT_SUCCESS\";\n    StashWindowEvent[\"PURCHASE_PROCESSING\"] = \"PURCHASE_PROCESSING\";\n})(StashWindowEvent || (StashWindowEvent = {}));\nexport default function StashPay({ isOpen, checkoutUrl, onClose, onPurchaseSuccess, onPurchaseFailed }) {\n    const [isLoading, setIsLoading] = useState(true);\n    const iframeRef = useRef(null);\n    useEffect(() => {\n        // Reset loading state when modal opens or closes\n        // Use setTimeout to defer state update and avoid linter warning\n        const timer = setTimeout(() => {\n            if (isOpen && checkoutUrl) {\n                setIsLoading(true);\n            }\n            else if (!isOpen) {\n                setIsLoading(true);\n            }\n        }, 0);\n        return () => clearTimeout(timer);\n    }, [isOpen, checkoutUrl]);\n    // Listen for messages from iframe via window.parent.postMessage()\n    useEffect(() => {\n        const handleMessage = (event) => {\n            if (typeof event.data !== 'object' || event.data === null || !('eventName' in event.data)) {\n                return;\n            }\n            const data = event.data;\n            const eventName = data.eventName;\n            if (typeof eventName !== 'string') {\n                return;\n            }\n            // Remove \"STASH_WINDOW_EVENT__\" prefix to get the enum value\n            const eventType = eventName.replace('STASH_WINDOW_EVENT__', '');\n            if (!Object.values(StashWindowEvent).includes(eventType)) {\n                return;\n            }\n            // Extract any additional data (excluding eventName)\n            const rest = { ...data };\n            delete rest.eventName;\n            const eventData = Object.keys(rest).length > 0 ? rest : undefined;\n            // Call appropriate callback based on event type\n            if (eventType === StashWindowEvent.PAYMENT_SUCCESS) {\n                onClose(); // Auto-close on success\n                if (onPurchaseSuccess) {\n                    onPurchaseSuccess(eventData);\n                }\n            }\n            else if (eventType === StashWindowEvent.PAYMENT_FAILURE) {\n                onClose(); // Auto-close on failure\n                if (onPurchaseFailed) {\n                    onPurchaseFailed(eventData);\n                }\n            }\n        };\n        if (isOpen) {\n            window.addEventListener('message', handleMessage);\n            return () => {\n                window.removeEventListener('message', handleMessage);\n            };\n        }\n    }, [isOpen, onClose, onPurchaseSuccess, onPurchaseFailed]);\n    const handleIframeLoad = () => {\n        // Iframe has loaded and rendered - stop loading animation\n        setIsLoading(false);\n    };\n    if (!checkoutUrl)\n        return null;\n    return (_jsxs(\"div\", { className: `fixed inset-0 z-50 flex items-end justify-center transition-opacity duration-300 ${isOpen ? 'opacity-100 pointer-events-auto' : 'opacity-0 pointer-events-none'}`, children: [_jsx(\"div\", { className: \"absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity duration-300\", onClick: onClose }), _jsxs(\"div\", { className: `relative w-full max-w-md bg-black rounded-t-3xl shadow-2xl transform transition-all duration-700 ease-[cubic-bezier(0.32,0.72,0,1)] overflow-hidden ${isOpen ? 'translate-y-0' : 'translate-y-full'}`, onClick: (e) => e.stopPropagation(), style: {\n                    height: isLoading ? '400px' : '90vh',\n                    maxHeight: '90vh',\n                    boxShadow: '0 -4px 24px rgba(0, 0, 0, 0.5)',\n                    transition: 'height 700ms cubic-bezier(0.32, 0.72, 0, 1), transform 700ms cubic-bezier(0.32, 0.72, 0, 1)',\n                }, children: [_jsx(\"div\", { className: \"absolute top-0 left-0 right-0 flex justify-center pt-3 pb-2 z-20 pointer-events-none\", children: _jsx(\"div\", { className: \"w-12 h-1.5 bg-gray-600 rounded-full\" }) }), _jsx(\"button\", { onClick: onClose, className: \"absolute top-4 right-4 z-20 p-2 bg-gray-800/90 backdrop-blur-sm rounded-full shadow-lg text-gray-300 hover:text-white hover:bg-gray-700 transition-all\", \"aria-label\": \"Close\", children: _jsx(\"svg\", { className: \"w-5 h-5\", fill: \"none\", strokeLinecap: \"round\", strokeLinejoin: \"round\", strokeWidth: \"2\", viewBox: \"0 0 24 24\", stroke: \"currentColor\", children: _jsx(\"path\", { d: \"M6 18L18 6M6 6l12 12\" }) }) }), isLoading && (_jsx(\"div\", { className: \"absolute inset-0 overflow-hidden bg-black z-10 flex items-center justify-center\", children: _jsx(\"div\", { className: \"w-12 h-12 border-4 border-gray-600 border-t-gray-300 rounded-full animate-spin\" }) })), _jsx(\"div\", { className: `absolute inset-0 transition-all duration-700 ease-out ${isLoading\n                            ? 'opacity-0 pointer-events-none z-0'\n                            : 'opacity-100 z-0'}`, children: _jsx(\"iframe\", { ref: iframeRef, src: checkoutUrl, className: \"w-full h-full border-0\", onLoad: handleIframeLoad, title: \"Stash Payment\", allow: \"payment\", sandbox: \"allow-forms allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox\" }, checkoutUrl) })] })] }));\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 164, "column": 0}, "map": {"version":3,"sources":["file:///Users/ondrejrehacek/Git/Stash/stash-pay-web/packages/stash-pay/dist/index.js"],"sourcesContent":["export { default as StashPay } from './StashPay';\nexport { StashWindowEvent } from './StashPay';\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 181, "column": 0}, "map": {"version":3,"sources":["file:///Users/ondrejrehacek/Git/Stash/stash-pay-web/sample/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { StashPay } from '@stash/stash-pay';\n\nexport default function Home() {\n  const [loading, setLoading] = useState(false);\n  const [checkoutUrl, setCheckoutUrl] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [purchaseResult, setPurchaseResult] = useState<{ success: boolean; data?: Record<string, unknown> } | null>(null);\n\n  const generateCheckoutLink = async () => {\n    setLoading(true);\n    setError(null);\n    setCheckoutUrl(null);\n\n    try {\n      const response = await fetch('/api/checkout', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({}), // Uses default payload from API route\n      });\n\n      const data = await response.json();\n\n      if (!response.ok) {\n        throw new Error(data.error || 'Failed to generate checkout link');\n      }\n\n      setCheckoutUrl(data.url);\n      setIsModalOpen(true);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'An error occurred');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCloseModal = () => {\n    setIsModalOpen(false);\n  };\n\n  const handlePurchaseSuccess = (data?: Record<string, unknown>) => {\n    setPurchaseResult({ success: true, data });\n    console.log('Purchase successful:', data);\n  };\n\n  const handlePurchaseFailed = (data?: Record<string, unknown>) => {\n    setPurchaseResult({ success: false, data });\n    console.log('Purchase failed:', data);\n  };\n\n  return (\n    <main className=\"flex min-h-screen flex-col items-center justify-center p-24\">\n      <div className=\"max-w-2xl w-full space-y-6\">\n        <h1 className=\"text-4xl font-bold mb-4 text-center\">Stash Checkout Web Component</h1>\n        \n        <button\n          onClick={generateCheckoutLink}\n          disabled={loading}\n          className=\"w-full px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors\"\n        >\n          {loading ? 'Generating...' : 'Generate Checkout Link'}\n        </button>\n\n        {error && (\n          <div className=\"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700\">\n            <p className=\"font-semibold\">Error:</p>\n            <p>{error}</p>\n          </div>\n        )}\n\n        {purchaseResult && (\n          <div\n            className={`p-4 border rounded-lg ${\n              purchaseResult.success\n                ? 'bg-green-50 border-green-200 text-green-800'\n                : 'bg-red-50 border-red-200 text-red-800'\n            }`}\n          >\n            <p className=\"font-semibold\">\n              {purchaseResult.success ? '✓ Payment Successful' : '✗ Payment Failed'}\n            </p>\n            {purchaseResult.data && (\n              <pre className=\"mt-2 text-xs overflow-auto\">\n                {JSON.stringify(purchaseResult.data, null, 2)}\n              </pre>\n            )}\n          </div>\n        )}\n      </div>\n\n      <StashPay\n        isOpen={isModalOpen}\n        checkoutUrl={checkoutUrl}\n        onClose={handleCloseModal}\n        onPurchaseSuccess={handlePurchaseSuccess}\n        onPurchaseFailed={handlePurchaseFailed}\n      />\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAHA;;;;AAKe,SAAS;IACtB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAgB;IAC9D,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAClD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAC/C,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAA8D;IAElH,MAAM,uBAAuB;QAC3B,WAAW;QACX,SAAS;QACT,eAAe;QAEf,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,iBAAiB;gBAC5C,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC,CAAC;YACxB;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAEhC,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;YAChC;YAEA,eAAe,KAAK,GAAG;YACvB,eAAe;QACjB,EAAE,OAAO,KAAK;YACZ,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;QAChD,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,mBAAmB;QACvB,eAAe;IACjB;IAEA,MAAM,wBAAwB,CAAC;QAC7B,kBAAkB;YAAE,SAAS;YAAM;QAAK;QACxC,QAAQ,GAAG,CAAC,wBAAwB;IACtC;IAEA,MAAM,uBAAuB,CAAC;QAC5B,kBAAkB;YAAE,SAAS;YAAO;QAAK;QACzC,QAAQ,GAAG,CAAC,oBAAoB;IAClC;IAEA,qBACE,8OAAC;QAAK,WAAU;;0BACd,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAAsC;;;;;;kCAEpD,8OAAC;wBACC,SAAS;wBACT,UAAU;wBACV,WAAU;kCAET,UAAU,kBAAkB;;;;;;oBAG9B,uBACC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAE,WAAU;0CAAgB;;;;;;0CAC7B,8OAAC;0CAAG;;;;;;;;;;;;oBAIP,gCACC,8OAAC;wBACC,WAAW,CAAC,sBAAsB,EAChC,eAAe,OAAO,GAClB,gDACA,yCACJ;;0CAEF,8OAAC;gCAAE,WAAU;0CACV,eAAe,OAAO,GAAG,yBAAyB;;;;;;4BAEpD,eAAe,IAAI,kBAClB,8OAAC;gCAAI,WAAU;0CACZ,KAAK,SAAS,CAAC,eAAe,IAAI,EAAE,MAAM;;;;;;;;;;;;;;;;;;0BAOrD,8OAAC,+LAAQ;gBACP,QAAQ;gBACR,aAAa;gBACb,SAAS;gBACT,mBAAmB;gBACnB,kBAAkB;;;;;;;;;;;;AAI1B"}},
    {"offset": {"line": 341, "column": 0}, "map": {"version":3,"sources":["file:///Users/ondrejrehacek/Git/Stash/stash-pay-web/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":"AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF","ignoreList":[0]}},
    {"offset": {"line": 360, "column": 0}, "map": {"version":3,"sources":["file:///Users/ondrejrehacek/Git/Stash/stash-pay-web/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0]}},
    {"offset": {"line": 365, "column": 0}, "map": {"version":3,"sources":["file:///Users/ondrejrehacek/Git/Stash/stash-pay-web/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n"],"names":["module","exports","require","vendored","React"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,KAAK","ignoreList":[0]}},
    {"offset": {"line": 370, "column": 0}, "map": {"version":3,"sources":["file:///Users/ondrejrehacek/Git/Stash/stash-pay-web/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n"],"names":["module","exports","require","vendored","ReactJsxRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,eAAe","ignoreList":[0]}}]
}